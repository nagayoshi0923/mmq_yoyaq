#!/usr/bin/env python3
"""
スプレッドシートデータからシナリオ情報を抽出
"""

import json
import re

# スプレッドシートデータ（タブ区切り）
raw_data = """	グロリアメモリーズ	10	4~4.5	4500→5,000	あり/オープンの場合なし(※貸切は有のみ）	1	きゅう、れみあ
	マーダー・オブ・パイレーツ	10	4	準備中	なし	1	えなみ
新作	over kill	10	4	6000円(見学2500円？）	なし	1	八継ジノ(限定)
時間キュウ確認	BrightChoice	9	4~4.5	4500→5000	なし	1	えなみ、きゅう、れみあ
時間キュウ確認	裁くもの、裁かれるもの	9	4~4.5	4500→5000円	なし	1	れいにー、きゅう、えなみ
	星	9	4.5	準備中		1	りえぞー（予定）準備中
	清流館の秘宝	9	3.5	現在公演中止	なし	1	まつい
	奪うもの、奪われるもの	9	5〜5.5	5500円→6000円変更検討	なし	1	れいにー、きゅう
新作	超特急の呪いの館で撮れ高足りてますか？	9	3.5~4	5,000円	なし	1	キュウ、そら、ぴよな、まつかさ、あんころ、松坊
新作	曙光のエテルナ	8	4	4,500円	なし	1	えりん、じの、つばめ、しらやま、温風リン、奏兎
	BBA	8	5	5500円	なし	1	みずき、つばめ、りえぞー
	DearmyD	8	4.5	5,000円	なし	1	れみあ、えなみ、れいにー、つばめ、崎
	Iwillex-	8	4	4,500	なし	1	ぽん、れみあ、えなみ、れいにー、崎
	Recollection	8	4〜4.5	5,000	なし	1	みずき、しらやま、そら
	WANTEDz	8	3	4,000	なし	1	まつい、えなみ
	アンフィスバエナと聖女の祈り	8	4	5,000	なし	1	ぽん、りえぞー、まつい
	ウロボロスの眠り	8	4	4,500	なし	1	えなみ、まつい、きゅう
	クリエイターズハイ	8	3.5〜4	4,500	なし	1	えなみ、きゅう、りえぞー
	つわものどもが夢のあと	8	3	4,000	なし	1	みずき、きゅう、れいにー
	ドクター・テラスの秘密の実験	8	3.5	4,000	なし	1	えなみ、きゅう
	バベルの末裔	8		準備中	なし	1	えなみ、りえぞー
	ヒーロースクランブル	8	3.5	4,000	なし	1	えなみ
	ひぐらしのなく頃に　恨返し編	8	3.5	4,500	なし	1	りえぞー
	フェイクドナー	8	3.5	4,500	なし	1	えりん、みずき、れいにー、しらやま
	リアルマダミス-MurderWonderLand	8	3	4,000	なし	1	みずき、えりん、れいにー、つばめ
	リアルマダミス-盤上の教皇	8	3	4,000	なし	1	みずき、れいにー
	リトルワンダー	8	3.5	4,000→4,500	なし	1	みずき、つばめ
	悪意の岐路に立つ	8	4	4,000	なし	1	まつい、えなみ、labo
	或ル胡蝶ノ夢	8	4~4.5	5,000円	なし	1	りえぞー、ぽん、まつい、えりん、みずき、あんころ、キュウ、りんな、しらやま、崎
	花街リグレット	8	4	4,500	なし	1	きゅう、りえぞー、えりん、みずき、しらやま、じの
	銀世界のアシアト	8	4/4.5	5,000	あり/なし	1	えなみ、きゅう、まつい、りんな、しらやま、ぴよな、ソルト、りえぞー、崎、ソラ
	黒と白の狭間に	8	3.5	4000→4,500	なし	1	えなみ、えりん、れみあ、しらやま、つばめ
	裁判員の仮面	8	3.5~4	4,500	なし	1	えなみ、まつい
	歯に噛むあなたに	8	4	5,000		1	きゅう
	鹿神館の罪人	8	3.5	4,000	なし	1	まつい、えなみ
	女皇の書架	8	3.5	4,500	なし	1	きゅう、りえぞー、えりん、じの
	新世界のユキサキ	8	4	5,000	あり	1	えなみ、崎、しらやま、じの、ぴよな、りんな、まつい、ソルト、りえぞー
	誠実な十字架	8	4	4,500	なし	1	えなみ、つばめ、ぴよな、じの
	鉄紺の証言	8	4	4,500	なし	1	えなみ、きゅう
	霧に眠るは幾つの罪	8	5.5~6	6,500	あり	1	えなみ、まつい、きゅう、れいにー、崎、ぽったー
	野槌	8	4	4,500	なし	1	きゅう
	贖罪のロザリオ	8		準備中	なし	1	
新作	機巧人形の心臓	8	4.5	5,000円	なし	1	じの、ぴよな、きゅう、つばめ、しらやま、ソルト、りえぞー、奏兎、みずき、えりん
新作	境界線のカーサスベリ	8	4.5	5,000円	なし	1	そら、つばめ、崎、しらやま、ソルト
新作	藍雨廻逢	8	4	4,500円	なし	1	そら、ぴよな、つばめ、じの、りんな、あんころ、らの、渚咲、BB
新作	月光の偽桜	8	4	4,500円	なし	1	つばめ、そら、ぴよな、しらやま、ソルト、まつかさ、まつい
未告知	アンシンメトリー	8	3	4,500円	配役のみあり	1	キュウ
新作	妖怪たちと月夜の刀	8	3.5	4,500円	なし	1	崎、じの、あんころ、そると、そら
未告知	九十九談 - 厄災の箱	8	4	5,000円	あり	1	崎、みずき
未告知	呪縛姫	8	4	5,000円	なし	1	
	桜の散る夜に	8	4		なし	1〜2?	
新作	白いウサギは歌わない	8	4	5000	なし	1	じの
	inthebox〜長い熱病	7	5~5.5	6,000円	なし	1	れいにー、じの、崎
	GARDENリーガー殺人事件	7	3.5	公演停止中	なし	1	りえぞー
	Jazzy	7	3.5	4,500円	なし	1	ぽん
新作	REDRUM01泉涌館の変転	7	3.5	4,000円	なし	1	ソラ
テスプ	アオハルーツ	7		公演未定	なし	1	えなみ、りえぞー
	アオハループ	7	4.5	5,000	なし	1	みくみん、みずき、りえぞー、しらやま、ぽん、つばめ、りんな
	あくなき世界で嘘をうたう	7	3.5	4,500	なし	1	ぽん、えなみ、みずき、りんな
	エデンの審判	7	4	4,500	なし	1	きゅう、崎
	キングを殺すには	7	4.５	3,000（オンライン）	あり	1	
	クロノフォビア	7	4	4,500/5,000	なし	1	ほがらか、りえぞー、きゅう、つばめ、モリシ
	スターループ	7	2.5〜3	4,000→4,500	なし	1	ぽん、れいにー、じの、ぴよな、しらやま
	ツグミドリ	7	3.5	4,500	なし	1	えなみ、りえぞー、きゅう、りんな、ソラ、えりん、まつい
	ナナイロの迷宮 黄 エレクトリカル吹奏楽部殺人事件	7	3.5	4000→4500	なし	1	ぽん、みずき、れいにー、きゅう、れみあ
新作	ナナイロの迷宮 緑 アペイロン研究所殺人事件	7	3.5	4500円	なし	1	きゅう、れみあ、りえぞー、つばめ
	ナナイロの迷宮 橙 オンラインゲーム殺人事件	7	3.5	4000→4500	なし	1	ぽん、みずき、れいにー、えりん、きゅう、れみあ、つばめ
	ピタゴラスの篝火	7	3	4,000	なし	1	きゅう、えなみ、れみあ
	フェイクアブダクション	7	4	4,500〜5,000予定	なし	1	
	ヤノハのフタリ	7	3.5	4,000	なし	1	えなみ、りえぞー
	ロックドドア殺人	7		公演準備中	なし	1	みくみん
	一条家の人々	7	3	4,000	なし	1	えなみ、きゅう
	花咲の箱庭	7	3	3500→4,000	なし	1	みずき
	学校の解談	7	4.5	5,000	なし	1	みずき、りえぞー、えりん、えなみ
	岐路に降り立つ	7	4	4,500	なし	1	まつい、きゅう、れみあ、えなみ
	季節のマーダーミステリー／ニィホン	7	4	4500円	なし	1	季節マダミスできる全てのGM
	季節マーダー／アニクシィ	7	3.5	4000→4,500	なし	1	ぽん、きゅう、えなみ、りえぞー、えりん、れみあ、れいにー、みずき、崎、りんな、つばめ
	季節マーダー／カノケリ	7	3.5	4000→4,500	なし	1	ぽん、きゅう、えなみ、りえぞー、えりん、れみあ、れいにー、みずき、崎、りんな、ぴよな、つばめ
	季節マーダー／キモナス	7	3.5	4000→4,500	なし	1	ぽん、れいにー、れみあ、きゅう、えなみ、りえぞー、えりん、崎、りんな、みずき
	季節マーダー／シノポロ	7	3.5	4000→4,500	なし	1	ぽん、れいにー、れみあ、きゅう、えなみ、りえぞー、えりん、崎、ぴよな、しらやま、みずき、りんな
	鬼哭館の殺人事件	7	4.5	4,500→5,000	なし	1	みずき、れいにー、まつい、ソラ
	古鐘のなる頃に	7	4	4,500	なし	1	まつい、えなみ、きゅう
	荒廃のマリス	7	3.5	4000→4,500円	なし	1	ぽん、きゅう、りえぞー、えりん、みずき、えなみ、まつい
	黒の眺望	7	3.5	4,500円	なし	1	まつい、だいこん
	今日も涙の雨が降る	7		4,000円公演停止中	なし	1	ほがらか
	殺神罪	7	3.5~4	4,500	なし	1	みずき、まつい、しらやま、つばめ
	殺人鬼イバラノミチの回想録	7	4	5,000	なし	1	ぽん、りえぞー、きゅう、れいにー、あんころ
	紫に染まる前に	7	3.5	4,500円	なし	1	まつい、えりん
	七股高校	7	3.5	公演準備中	なし	1	みくみん
	朱き亡国に捧げる祈り	7	3.5〜4	4,500	なし	1	きゅう、まつい、れいにー、えなみ、だいこん
	少年少女Aの独白	7	3.5	4,000	なし	1	りえぞー、えなみ
新作	真・渋谷陰陽奇譚	7	3.5~4	4,500円	なし	1	そら、崎
	人狼を語る館	7	3.5	4,500	なし	1	きゅう、まつい
	星空のマリス	7	3.5	4000→4,500円	なし	1	ぽん、えりん、きゅう、えなみ、りえぞー、みずき、まつい
	全能のパラドックス	7	4.5	5,000	なし	1	えなみ、ほがらか、もりし、ポッター、BB
	想いは満天の星に	7	3.5	4,000公演停止中	なし	1	
	探偵撲滅	7	5	5,000→5500	なし	1	みずき、じの
	天邪河（あまのじゃく）	7	4.5	5,000	なし	1	まつい、みずき、しらやま
新作	電脳の檻のアリス	7	4	5,000円	なし	1	えりん、じの、ぴよな、りえぞー
	白殺しType-K	7	2,5〜3	4,500	なし	1	きゅう、しらやま、えりん
	百鬼の夜、月光の影	7	4	4,500	なし	1	みずき、しらやま、りんな
	名探偵と四嶺館	7	3.5	4,000	なし	1	まつい
	傲慢な女王とアリスの不条理裁判	7	3.5	4,500	なし	1	ぽん、えりん、りえぞー、みずき、れいにー、りんな、しらやま
新作	彗星蘭の万朶	7	4.5	5,000	あり	1	しらやま、あんころ、りんな、じの
	燔祭のジェミニ	7	3.5	4,500	なし	1	えなみ、りえぞー、じの、つばめ、しらやま、りんな、えりん
準備中	絆の永逝	7	4.5	5,000	なし	1	ぽん、つばめ、崎、温風リン
新作	凪の鬼籍	7	4.5	5,000	なし	1	つばめ、崎
新作	異能特区シンギュラリティ	7	3~3.5	4,500円	なし	1	あんころ、楽
新作	くずの葉のもり	7	3	4,500円	なし	1	じの・つばめ・そら・りえぞー
新作	REDRUM4アルテミスの断罪	7	4	4,500円	なし	1	そら
新作	ENIGMACODE廃棄ミライの犠牲者たち	7	4	4500円	なし	1	ほがらか、じの、れみあ、ぽったー、BB、奏兎、楽
新作	テセウスの方舟	7	4	なし		1	ほがらか、つばめ、じの、ソラ、BB、ソルト、まつい、松坊、えりん
新作	探ぱんマーダーミステリー・ノーショーツトルダム学園殺人事件	7	3.5	4,500円	なし	1	じの
新作	蟻集	7	4	5,000	貸切のみ事前読み込みあり	1	キュウ、崎、ぴよな
新作	蝉散	7	4.5	5,500	貸切のみ事前読み込みあり	1	キュウ、崎
新作	その白衣は誰が為に	7	4	4,500円	なし	1	キュウ、じの
未告知	深海に沈む子供たち（水底のクオリア）	7	3.5		なし	1	じの
	5DIVE	6	4	5,000円	なし	1	きゅう、じの、しらやま、ぴよな
	MERCHANT	6	5/5.5~6	5,500円→6000円	あり/オープンの場合はなし	1	みかのは、しらやま
	readme.txt	6	3〜3.5	4,000円	なし	1	ほがらか
新作	REDRUM02虚像のF	6	3	4,000	なし	1	そら
新作	REDRUM03致命的観測をもう一度	6	3.5	4,500	なし	1	labo、そら、しらやま、えりん
	TOOLS〜ぎこちない椅子	6	4	4,500	なし	1	きゅう、れみあ、れいにー、ソラ
新作	アンドロイドは愛を知らない	6	4	4,500円	なし	1	つばめ、しらやま、じの、温風リン
	キヲクの方舟	6	3.5	4,000公演停止中	なし	1	ぽん
	クリムゾンアート	6	4	4,500円	なし	1	ぽん、りえぞー
	この闘をあなたと	6	4/4.5	5,000	あり/なし	1	みずき、あんころ、ぽん、そら、ソルト、温風リン
	デモンズボックス	6	4	4,500円	なし	1	えなみ、つばめ
	へっどぎあ★ぱにっく	6	3.5	4,000円	なし	1	えなみ、つばめ、キュウ、しらやま
	モノクローム	6	4	5,000/5,500	なし	２	りえぞー、しらやま、えりん、崎、じの
	ロスト／リメンブランス	6	4.5	5,500	なし	1	きゅう、れみあ、れいにー、らぼ
	愛する故に	6	4	4,500	なし	1	れいにー、みずき、モリシ、そら
	椅子戦争	6	4	4500円	なし	1	ほがらか、りえぞー
	違人	6	4	5,000円	なし	1	きゅう、labo
	火ノ神様のいうとおり	6	3.5	4,500	なし	1	きゅう、えなみ
	紅く舞う	6	3.5	4,500円	なし	1	まつい、きゅう
	告別詩	6	5	5,000円		1	しらやま、ぴよな、りえぞー
	殺人鬼Xの独白	6	3	4,500	なし	1	まつい、れみあ、れいにー、そら
	小暮事件に関する考察	6	3.5	4,500	なし	1	えなみ、まつい、れみあ、labo、そら、温風リン
	赤の導線	6	4~4.5	5,000円	なし	1	れいにー、えなみ、えりん、りえぞー、しらやま、ぴよな、つばめ
	凍てつくあなたに６つの灯火	6	4	4,500円	なし	1	りえぞー、えりん、まつい、あんころ
	彼とかじつとマシュマロウ	6	4	4,500円	なし	1	ぽん、りえぞー、ソルト、つばめ
	彼女といるかとチョコレート	6	3.5	4000→4,500	なし	1	ぽん、りえぞー、えりん、ソルト
	不思議の国の童話裁判	6	4	5,000/5,500（土日）	あり必須	2	みずき、りえぞー、えりん、つばめ、じの
	鳴神様のいうとおり	6	3.5	4000→4,500	なし	1	ぽん、きゅう、えなみ、りえぞー、渚咲
新作	立方館	6	6.5~7	9000/平日はクーポン1000渡す		1	labo、まつい、ぽったー
	裂き子さん	6	3~3.5	4,500円	なし	1	ぽん、りえぞー、みずき、きゅう、ぴよな、つばめ
新作	ゴージャスマンション	6	2.5	4,000	なし	1	だいこん、しらやま
新作	マーダーオブエクスプローラー失われし大秘宝	6	3	4,500円	なし	1	ソラ、だいこん
	漣の向こう側	6	3	4,500円	なし	1	じの、つばめ、ぴよな、まつかさ
	土牢に悲鳴は谺して	6	4	4,500円	なし	1	まつい・きゅう・そら
新作	オペレーション：ゴーストウィング	6	3	4,500	なし	1	えなみ、そら、りんな、まつかさ、楽
新作	ある悪魔の儀式について	6	2.5	4,500円	なし	1	えなみ、れみあ、BB、温風リン、奏兎、雨宮ラノ、しらやま、まつい、渚咲
新作	ツイン号沈没事件に関する考察	6	3.5	4500	なし	1	えなみ、BB、温風リン
未告知	すべては山荘から始まる。	6	2.5					ソルト、N、楽
未告知	君が為の殺人	6	5	5500~6000？			ひなどり
	GM殺人事件	5	3	4000	なし	1	じの、りんな、あんころ、ソウタン、だいこん
未告知	BeatSpecter	5	3	4,500	なし		きゅう
	WORLDEND	5	3.5	4,500	なし	1	ぽん、りえぞー、あんころ、つばめ、みかのは
	あるマーダーミステリーについて	5	3	4,000	なし	1	えなみ、まつい、れみあ、りえぞー、えりん、れいにー、labo、しらやま、ソルト
	エイダ	5	3.5	4,000→4,500	なし	1	りえぞー、みずき、ソルト、しらやま、あんころ、渚咲、松坊、奏兎、ひなどり
欠番	ブラックナイトスレイヴ	5		※公演やってない	なし	1	
	ユートピアース	5	2.5~3	4,500	なし	1	しらやま・じの、つばめ、あんころ
	狂気山脈　2.5　頂上戦争	5	4	4,500	なし	1	れいにー、れみあ
	狂気山脈　陰謀の分水嶺（１）	5	4	4,500	なし	1	れいにー、れみあ
	狂気山脈　星降る天辺（２）	5	4	4,500	なし	1	れいにー、れみあ
	狂気山脈　薄明三角点（３）	5	4	4,500	なし	1	れいにー、れみあ
欠番	午前2時7分	5	3	※公演やってない	なし	1	えなみ、きゅう、れみあ
	黒い森の獣part1	5	4.5	5000円	なし	1	まつい、れいにー
	黒い森の獣part2人と狼	5	4.5	5000円	なし	1	まつい、れいにー
	魂を運ぶ飛行船	5	3.5	4,500円	なし	1	つばめ、りんな、ソルト、奏兎、BB、ひなどり
	人類最後の皆様へ／終末の眠り姫	5	4	4000→4,500	なし	1	あんころ
	正義はまた蘇る	5	3	4,000	なし	1	えなみ、まつい
	天使は花明かりの下で	5	4	4,500→5,000	なし	1	りえぞー、みずき、ぴよな、ぽん、しらやま、あんころ
	南極地点X	5	2.5	3500→4,000	なし	1	れいにー、まつい
	僕らの未来について	5	3	4,000	なし	1	まつい
	魔女の聖餐式	5		※公演やってない	なし		えなみ
	流年	5	6	6,000	あり/なし	1	えりん、れいにー、モリシ、あんころ
新作	廻る弾丸輪舞（ダンガンロンド）	5	2.5	4,000円→4,500円	なし	1	まつい・そら
	TheRealFork30's	5	3	4,500円	なし	1	ソラ、りえぞー、キュウ
	檻見る5人-（空色時箱セット公演）	5	4	5,000円	なし	1	そら、つばめ
	空色時箱（ソライロタイムカプセル）-檻見る５人セット公演	5	4	5,000円	なし	1	つばめ、そら
準備中	MissingLink（ミッシングリンク）	5	3	4000円	なし	1	えなみ
	ゼロの爆弾	5	2.5	4,000円→4,500円	なし	1	そら、じの、らの
	赤鬼が泣いた夜	5	3	4,500円	なし	1	つばめ、まつかさ、楽、松坊
準備中	親方の館	5				1	
	SORCIER～賢者達の物語～	4	3.5	4,000	なし	1	きゅう、みずき、つばめ
欠番	あの夏のアンタレス	4		公演未定		1	れいにー、ぽん
	エンドロールは流れない	4	4/4.5	平日4,500/土日5,000	あり/なし	1	みずき、あんころ、ぽん、そら、ソルト、温風リン
準備中	幻想のマリス	4		公演未定	なし	1	れいにー、きゅう、えなみ、みずき
新作	Invisible-亡霊列車-	4	2	3500円	なし	1	えなみ、じの、そら、キュウ、つばめ、古賀、あんころ、みかのは、りえぞー、kanade、奏兎、松坊
準備中	口裂け女の微笑み・Mの悪意	4	3	4,500円	なし	1	未定
準備中	Factor	4	2.5-3	4,500円		1	
新作	ブルーダイヤの不在証明	4	3	平日4,500／土日5,000	なし	1	えなみ、じの、N、そら、えりん、しらやま、松坊、雨宮ラノ、小川はねか、ひなどり、まつい
準備中	Grape	2	3.5	※公演やってない	なし	1	
未告知	人狼デスゲームへの挑戦		2"""

def parse_price(price_str):
    """価格文字列をパース"""
    if not price_str or price_str in ['準備中', '公演停止中', '公演未定', 'なし', '※公演やってない']:
        return "不明"
    
    # 最初の数字を抽出
    match = re.search(r'(\d[,\d]*)', price_str.replace(',', ''))
    if match:
        val = match.group(1)
        return f"{int(val):,}円"
    return "不明"

def parse_duration(duration_str):
    """時間文字列をパース"""
    if not duration_str:
        return "不明"
    
    duration_str = duration_str.strip()
    if not duration_str:
        return "不明"
    
    # 〜や~を統一
    duration_str = duration_str.replace('~', '〜').replace('/', '〜')
    
    # 数字を含むか確認
    if re.search(r'\d', duration_str):
        # すでに「時間」が含まれていればそのまま
        if '時間' in duration_str:
            return duration_str
        else:
            return f"{duration_str}時間"
    
    return "不明"

scenarios = []
lines = raw_data.strip().split('\n')

for line in lines:
    parts = line.split('\t')
    if len(parts) < 5:
        continue
    
    # 最初の列はステータス（新作、準備中など）
    status = parts[0].strip()
    title = parts[1].strip() if len(parts) > 1 else ""
    players = parts[2].strip() if len(parts) > 2 else ""
    duration = parts[3].strip() if len(parts) > 3 else ""
    price = parts[4].strip() if len(parts) > 4 else ""
    
    # タイトルが数字のみの場合はスキップ（パースエラー）
    if title.isdigit():
        continue
    
    if not title:
        continue
    
    # 公演していないものはスキップ
    skip_keywords = ['公演やってない', '公演停止中', '公演未定', '欠番']
    if any(kw in status or kw in price for kw in skip_keywords):
        continue
    
    # 人数をパース
    if players:
        if players.isdigit():
            players = f"{players}人"
        elif '〜' in players or '~' in players or '-' in players:
            players = players.replace('~', '〜').replace('-', '〜') + "人"
        else:
            players = f"{players}人"
    else:
        players = "不明"
    
    scenarios.append({
        'title': title,
        'players': players,
        'duration': parse_duration(duration),
        'price': parse_price(price),
        'status': status if status else "公演中"
    })

# 重複除去
seen = set()
unique = []
for s in scenarios:
    if s['title'] not in seen:
        seen.add(s['title'])
        unique.append(s)
        print(f"✓ {s['title']} | {s['players']} | {s['duration']} | {s['price']}")

print(f"\n合計: {len(unique)} シナリオ")

# JSONで保存
with open('docs/data/queens-waltz-scenarios-internal.json', 'w', encoding='utf-8') as f:
    json.dump(unique, f, ensure_ascii=False, indent=2)

# Markdownで保存
with open('docs/data/queens-waltz-scenarios.md', 'w', encoding='utf-8') as f:
    f.write("# クインズワルツ シナリオリスト\n\n")
    f.write("出典: 内部スプレッドシート + https://queenswaltz.jp/catalog\n\n")
    f.write("## シナリオ一覧\n\n")
    f.write("| タイトル | 人数 | 時間 | 公演金額 |\n")
    f.write("|---------|------|------|----------|\n")
    
    for s in unique:
        title = s['title'].replace('|', '｜')
        f.write(f"| {title} | {s['players']} | {s['duration']} | {s['price']} |\n")
    
    f.write(f"\n---\n\n*合計: {len(unique)}シナリオ*\n")

print("\n保存完了!")

